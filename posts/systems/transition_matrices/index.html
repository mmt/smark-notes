<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>State Transition Matrices - sMark Notes [DRAFT]</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="State Transition Matrices">
<meta itemprop="description" content="This post has a few tricks for deriving state transitions matrices. These matrices arise when studying linear ODEs, for example: $$ \frac{d}{dt} x(t) = F(t)x(t) &#43; G(t) u(t), \qquad x(t_0) = x_0 $$ where
 $F: [t_0, t_f] \rightarrow \mathbb{R}^{n\times n}$ is the state matrix, $G: [t_0, t_f] \rightarrow \mathbb{R}^{n \times m}$ is the input matrix, $u: [t_0, t_f] \rightarrow \mathbb{R}^m $ is the input, $x: [t_0, t_f] \rightarrow \mathbb{R}^n$ is the solution of the ODE.">
<meta itemprop="datePublished" content="2020-12-28T23:38:22-08:00" />
<meta itemprop="dateModified" content="2020-12-28T23:38:22-08:00" />
<meta itemprop="wordCount" content="435">



<meta itemprop="keywords" content="linear-systems," />
<meta property="og:title" content="State Transition Matrices" />
<meta property="og:description" content="This post has a few tricks for deriving state transitions matrices. These matrices arise when studying linear ODEs, for example: $$ \frac{d}{dt} x(t) = F(t)x(t) &#43; G(t) u(t), \qquad x(t_0) = x_0 $$ where
 $F: [t_0, t_f] \rightarrow \mathbb{R}^{n\times n}$ is the state matrix, $G: [t_0, t_f] \rightarrow \mathbb{R}^{n \times m}$ is the input matrix, $u: [t_0, t_f] \rightarrow \mathbb{R}^m $ is the input, $x: [t_0, t_f] \rightarrow \mathbb{R}^n$ is the solution of the ODE." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mmt.github.io/smark-notes/posts/systems/transition_matrices/" />
<meta property="article:published_time" content="2020-12-28T23:38:22-08:00" />
<meta property="article:modified_time" content="2020-12-28T23:38:22-08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="State Transition Matrices"/>
<meta name="twitter:description" content="This post has a few tricks for deriving state transitions matrices. These matrices arise when studying linear ODEs, for example: $$ \frac{d}{dt} x(t) = F(t)x(t) &#43; G(t) u(t), \qquad x(t_0) = x_0 $$ where
 $F: [t_0, t_f] \rightarrow \mathbb{R}^{n\times n}$ is the state matrix, $G: [t_0, t_f] \rightarrow \mathbb{R}^{n \times m}$ is the input matrix, $u: [t_0, t_f] \rightarrow \mathbb{R}^m $ is the input, $x: [t_0, t_f] \rightarrow \mathbb{R}^n$ is the solution of the ODE."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://mmt.github.io/smark-notes/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://mmt.github.io/smark-notes/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://mmt.github.io/smark-notes/css/dark.css" />

	
		<script src="https://mmt.github.io/smark-notes/js/main.js"></script>
        <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true,
      tags: 'ams'

    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://mmt.github.io/smark-notes/">sMark Notes [DRAFT]</a></h1>
	<div class="site-description"><p>Mark M. Tobenkin&rsquo;s Notes on Mathematics and Other Topics</p><nav class="nav social">
			<ul class="flat"></ul>
		</nav></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/smark-notes/">Home</a>
			</li>
			
			<li>
				<a href="/smark-notes/posts">All posts</a>
			</li>
			
			<li>
				<a href="/smark-notes/about">About</a>
			</li>
			
			<li>
				<a href="/smark-notes/lists">Bookmarks</a>
			</li>
			
			<li>
				<a href="/smark-notes/notation">Notation</a>
			</li>
			
			<li>
				<a href="/smark-notes/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">28</span>
							<span class="rest">Dec 2020</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">State Transition Matrices</h1>
				</div>
			</div>

			<div class="markdown">
				<p>This post has a few tricks for
deriving
<a href="https://en.wikipedia.org/wiki/State-transition_matrix">state transitions matrices</a>.
These matrices arise when studying linear ODEs, for example:
$$
\frac{d}{dt} x(t) = F(t)x(t) + G(t) u(t), \qquad x(t_0) = x_0
$$
where</p>
<ul>
<li>$F: [t_0, t_f] \rightarrow \mathbb{R}^{n\times n}$ is the state matrix,</li>
<li>$G: [t_0, t_f] \rightarrow \mathbb{R}^{n \times m}$ is the input matrix,</li>
<li>$u: [t_0, t_f] \rightarrow \mathbb{R}^m $ is the input,</li>
<li>$x: [t_0, t_f] \rightarrow \mathbb{R}^n$ is the solution of the ODE.</li>
</ul>
<p>Time-varying linear ODEs of this sort generally arise from linearizing
a non-linear system of equations around a nominal solution.</p>
<p>The solution of this linear ODE can be written as:
$$
x(t) = \Phi(t, t_0) x(t_0) + \int_{t_0}^t \Phi(t, s) G(s) u(s)\; ds
$$</p>
<p>where $\Phi: [t_0, t_f] \times [t_0, t_f] \rightarrow \mathbb{R}^{n
\times n}$ is the state transition matrix.  This matrix itself is the
solution of the autonomous linear ODE:
$$
\begin{equation}
\frac{d}{dt} \Phi(t, \tau) = F(t) \Phi(t, \tau), \qquad \Phi(\tau, \tau) = I. \label{eq:fund_mat}
\end{equation}
$$</p>
<h1 id="solving-for-phi">Solving for $\Phi$</h1>
<p>In general there won&rsquo;t be a closed form solution for Equation
$\eqref{eq:fund_mat}$ but in many navigation problems such a solution
does exist.  When this solution is not available or too expensive to
implement one can resort to numerical integration of the ODE.
Another approach is to apply an expansion such as the <a href="https://arxiv.org/abs/1011.1775">Peano-Baker Series</a>:
$$
\Phi(t, \tau) = \sum_{n=0}^\infty \mathcal{I}_n(t, \tau),
\qquad
\mathcal{I}_0(t, \tau) = I, \qquad \mathcal{I}_{n+1}(t, \tau) = \int_\tau^t A(s) \mathcal{I}_{n}(s) \; ds.
$$
This series can also be used to derive exact formulas in some circumstances.</p>
<h2 id="linear-time-invariant-case">Linear Time-Invariant Case</h2>
<p>In the case where $F$ is constant (i.e. $F(t) \equiv F_0$) the solution is given simply by:
$$
\Phi(t, \tau) = \exp((t-\tau) F_0)
$$
so that the overall solution reads:
$$
x(t) = \exp((t-\tau)F_0) x(t_0) + \int_{t_0}^t \exp((t-s)F_0) G(s) u(s)\; ds
$$</p>
<h2 id="block_triangular">Solution for Block Triangular $F$</h2>
<p>Say $F$ is of the form:
$$F(t) = \begin{bmatrix} F_{11}(t) &amp; F_{12}(t) \\ 0 &amp; F_{22}(t)\end{bmatrix}.$$
Then $\Phi$ can also be written as:
$$\Phi(t, \tau) = \begin{bmatrix} \Phi_{11}(t, \tau) &amp; \Phi_{12}(t, \tau) \\ 0 &amp; \Phi_{22}(t, \tau)\end{bmatrix},$$
with $\Phi_{11}$ and $\Phi_{22}$ being the state-transition matrices associated with $F_{11}$ and $F_{22}$ independently:
$$
\begin{align}
\frac{d}{dt} \Phi_{ii}(t, \tau) &amp;= F_{ii}(t) \Phi_{ii}(t, \tau), \qquad \Phi_{ii}(\tau, \tau) = I \qquad i \in \{1, 2\}. \\<br>
\end{align}
$$
and
$$
\Phi_{12}(t, \tau) = \int_{\tau}^t \Phi_{11}(t, s) F_{12}(s) \Phi_{22}(s, \tau) ; ds.
$$</p>
<blockquote>
<p><em>Proof</em>:
This result can be verified by noting that $\Phi(t, t) = I$ and differentiating $\Phi$:
$$
\frac{d}{dt} \Phi(t, \tau)
= \begin{bmatrix}
F_{11}(t) \Phi_{11}(t, \tau) &amp; F_{12}(t)\Phi_{22}(t, \tau) + F_{11}(t) \Phi_{12}(t, \tau) \\<br>
0 &amp; F_{11}(t) \Phi_{22}(t, \tau)
\end{bmatrix} = F(t) \Phi(t, \tau).
$$</p>
</blockquote>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/smark-notes/tags/linear-systems">linear-systems</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
        <script src="https://utteranc.es/client.js"
        repo="mmt/smark-notes"
        issue-term="pathname"
        label="utterances-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  Â© Copyright Mark M. Tobenkin 2020 |  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


</body>
</html>
